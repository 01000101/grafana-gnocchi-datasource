<div class="editor-row" style="margin-top: 10px;">

  <div  ng-repeat="target in panel.targets"
        style="margin-bottom: 10px;"
        ng-class="{'tight-form-disabled': target.hide}"
        ng-controller="PrometheusQueryCtrl"
        ng-init="init()">

    <div class="tight-form">
      <ul class="tight-form-list pull-right">
        <li class="tight-form-item">
          <div class="dropdown">
            <a  class="pointer dropdown-toggle"
              data-toggle="dropdown"
              tabindex="1">
              <i class="fa fa-bars"></i>
            </a>
            <ul class="dropdown-menu pull-right" role="menu">
              <li role="menuitem">
                <a  tabindex="1"
                  ng-click="duplicate()">
                  Duplicate
                </a>
              </li>
              <li role="menuitem">
                <a  tabindex="1"
                  ng-click="moveMetricQuery($index, $index-1)">
                  Move up
                </a>
              </li>
              <li role="menuitem">
                <a  tabindex="1"
                  ng-click="moveMetricQuery($index, $index+1)">
                  Move down
                </a>
              </li>
            </ul>
          </div>
        </li>
        <li class="tight-form-item last">
          <a class="pointer" tabindex="1" ng-click="removeDataQuery(target)">
            <i class="fa fa-remove"></i>
          </a>
        </li>
      </ul>

      <ul class="tight-form-list">
        <li>
          <a  class="tight-form-item"
              ng-click="target.hide = !target.hide; get_data();"
              role="menuitem">
            <i class="fa fa-eye"></i>
          </a>
        </li>
      </ul>

      <ul class="tight-form-list" role="menu">
        <li class="tight-form-item" style="width: 86px">
          Query
        </li>
        <li>
          <input type="text"
                 class="input-large tight-form-input"
                 ng-model="target.expr"
                 spellcheck='false'
                 placeholder="query expression"
                 data-min-length=0 data-items=100
                 ng-blur="refreshMetricData()"
                 >
          <a bs-tooltip="target.errors.query"
             style="color: rgb(229, 189, 28)"
             ng-show="target.errors.query">
            <i class="fa fa-warning"></i>
          </a>
        </li>
        <li class="tight-form-item">
          Metric
        </li>
        <li>
          <input type="text"
                 class="input-large tight-form-input"
                 ng-model="target.metric"
                 spellcheck='false'
                 bs-typeahead="suggestMetrics"
                 placeholder="metric name"
                 data-min-length=0 data-items=100
                 >
          <a bs-tooltip="target.errors.metric"
             style="color: rgb(229, 189, 28)"
             ng-show="target.errors.metric">
            <i class="fa fa-warning"></i>
          </a>
        </li>

        <li class="tight-form-item">
          Alias:
        </li>
        <li>
          <input type="text"
                 class="tight-form-input input-medium"
                 ng-model="target.alias"
                 spellcheck='false'
                 placeholder="series alias"
                 data-min-length=0 data-items=100
                 ng-blur="refreshMetricData()"
                 />
        </li>

      </ul>

      <div class="clearfix"></div>
    </div>

    <div class="tight-form">
      <ul class="tight-form-list" role="menu">
        <li class="tight-form-item">
          <i class="fa fa-eye invisible"></i>
        </li>

        <li class="tight-form-item" style="width: 86px">
          Labels
        </li>
        <li ng-repeat="(key, flag) in target.labels track by $index" class="tight-form-item">
          {{key}}
          <a ng-click="removeLabel(key)">
            <i class="fa fa-remove"></i>
          </a>
        </li>

        <li class="tight-form-item" ng-hide="addLabelMode">
          <a ng-click="addLabel()">
            <i class="fa fa-plus"></i>
          </a>
        </li>

        <li ng-show="addLabelMode">
            <input type="text"
                   class="input-small tight-form-input"
                   spellcheck='false'
                   data-min-length=0 data-items=100
                   ng-model="target.currentLabelKey"
                   placeholder="label key">
            <a ng-click="addLabel()">
              add label
            </a>
            <a bs-tooltip="target.errors.labels"
               style="color: rgb(229, 189, 28)"
               ng-show="target.errors.labels">
              <i class="fa fa-warning"></i>
            </a>
        </li>
      </ul>
      <div class="clearfix"></div>
    </div>

    <div class="tight-form">
      <ul class="tight-form-list" role="menu">
        <li class="tight-form-item">
          <i class="fa fa-eye invisible"></i>
        </li>

        <li class="tight-form-item" style="width: 86px">
          Step Factor
        </li>
        <li>
          <input type="text"
                 class="input-small tight-form-input"
                 ng-model="target.step_factor"
                 spellcheck='false'
                 placeholder="series step factor"
                 data-min-length=0 data-items=100
                 ng-blur="refreshMetricData()"
                 />
        </li>
      </ul>

      <div class="clearfix"></div>
    </div>

  </div>
</div>
